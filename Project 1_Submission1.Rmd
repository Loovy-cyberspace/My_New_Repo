---
title: "Project 1_Submission1"
author: "Luwei Zeng"
output: pdf_document
date: "2024-07-28"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.

Data is from this paper: https://pubmed.ncbi.nlm.nih.gov/33096026/

1. Create a git repository for your project and push at least once prior to the first presentation with all the code you are presenting in class. See grading breakdown for final submission and bonus for details.

2. Identify one gene, one continuous covariate, and two categorical covariates in the provided dataset. Note: Gene expression data and metadata are in two separate files and will need to be linked.
One gene:AIBG
One continuous covariate:ferritin(ng/ml)
Two categorical covariatesL sex, icu status

3. Generate the following three plots using ggplot2 for your covariates of choice:
```{r}
setwd("/Users/hekaiwei/Desktop/R class/project")
gene <- read.csv(file = "QBS103_GSE157103_genes.csv",row.names=1)
metadata <- read.csv(file = "QBS103_GSE157103_series_matrix.csv", row.names = 1)
#head(gene)
#head(metadata)

#convert to dataframe and switch column and row
A1BG_gene <- gene["A1BG", ]
A1BG_gene <- as.data.frame(t(A1BG_gene))
#head(A1BG_gene)

#combine A1BG gene expression and metadata
data_combined<-merge(A1BG_gene,metadata,by = "row.names")
colnames(data_combined)[1] <- "ID"
head(data_combined)


```

```{r}
library("tidyverse")
```

o Histogram for gene expression (5 pts)
```{r}
ggplot(data_combined,aes(x = A1BG)) +
  geom_histogram(binwidth=0.1,fill="darkgreen",color="grey50")+
  labs(title="Histogram of A1BG Gene Expression",
     x="A1BG Gene Expression",
     y="Frequency")+
  theme_classic(base_family = 'Courier',base_size = 12)

#range(data_combined$A1BG)
```

o Scatterplot for gene expression and continuous covariate (5 pts)
```{r}
#One continuous covariate:ferritin(ng/ml)

data_combined$ferritin.ng.ml. <- as.numeric(data_combined$ferritin.ng.ml.)

ggplot(data_combined, aes(x = ferritin.ng.ml., y = A1BG)) +
  geom_point(color="darkgreen") +
  labs(title="Scatterplot of A1BG Gene Expression vs Ferritin(ng/ml)",
       x = "Ferritin (ng/ml)",
       y = "A1BG Gene Expression") +
  scale_x_continuous(limits = c(0, 6000), breaks = seq(0, 6000, by = 500)) +
  theme_classic(base_family = 'Courier',base_size = 12)

```

o Boxplot of gene expression separated by both categorical covariates (5 pts)


4. Present your scatterplot in class. Be prepared to explain the gene and covariate you chose and comment on the distribution as if you were presenting your research findings. No slides are required, just bring your plot. In class, be prepared to provide constructive feedback for your classmates (5 pts)

5. Submit your clearly commented code and generated plots as a knitted R markdown file.
